txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape$FIPS <- as.interger(txshape$FIPS)
tx.accidents    <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents    <- as.integer(tx.accidents[accidents$STATE==48,10])
tx.accidents    <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
txshape              <- fortify(txshape,region='FIPS')
colnames(txshape)[6] <- 'FIPS'
txshape <- left_join(x = txshape ,y = tx.accidents,by = 'FIPS')
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="group", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
)
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="group", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient(low = "lighgreen", high = "darkgreen")
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="group", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient(low = "lightgreen", high = "darkgreen")
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="group", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient("red")
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="group", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient(low = "red", high = "darkred")
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="group", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient(low = "white", high = "darkred") +
ggtitle('TX ACCIDENT COUNT DATA BY COUNTY')+
theme(plot.title = element_text(lineheight=1.5, face="bold"))
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
View(tx.accidents)
txshape <- left_join(x = txshape ,y = tx.accidents,by = 'FIPS')
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape$FIPS           <- as.interger(txshape$FIPS)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
txshape <- left_join(x = txshape ,y = tx.accidents,by = 'FIPS')
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape$FIPS           <- as.interger(txshape$FIPS)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
txshape$FIPS           <- as.interger(txshape$FIPS)
colnames(txshape)[6]   <- 'FIPS'
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.interger(txshape$FIPS)
txshape$FIPS           <- as.integer(txshape$FIPS)
#======================Texas County count plot==================
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.integer(txshape$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
txshape <- left_join(x = txshape ,y = tx.accidents,by = 'FIPS')
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.integer(txshape$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS      <-as.integer(tx.accidents$FIPS )
txshape <- left_join(x = txshape ,y = tx.accidents,by = 'FIPS')
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="group", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient(low = "white", high = "darkred") +
ggtitle('TX ACCIDENT COUNT DATA BY COUNTY')+
theme(plot.title = element_text(lineheight=1.5, face="bold"))
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.integer(txshape$FIPS)
unique(txshape$FIPS)
length(unique(txshape$FIPS))
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS      <-as.integer(tx.accidents$FIPS )
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="FIPS", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient(low = "white", high = "darkred") +
ggtitle('TX ACCIDENT COUNT DATA BY COUNTY')+
theme(plot.title = element_text(lineheight=1.5, face="bold"))
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.integer(txshape$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS      <-as.integer(tx.accidents$FIPS )
txshape <- left_join(x = txshape ,y = tx.accidents,by = 'FIPS')
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="FIPS", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient(low = "white", high = "darkred") +
ggtitle('TX ACCIDENT COUNT DATA BY COUNTY')+
theme(plot.title = element_text(lineheight=1.5, face="bold"))
View(txshape)
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.integer(txshape$FIPS)
View(txshape)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS      <-as.integer(tx.accidents$FIPS )
View(txshape)
View(tx.accidents)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[accidents$STATE==48,10])
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.integer(txshape$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS      <-as.integer(tx.accidents$FIPS )
txshape <- left_join(x = txshape ,y = tx.accidents,by = 'FIPS')
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="FIPS", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient(low = "white", high = "darkred") +
ggtitle('TX ACCIDENT COUNT DATA BY COUNTY')+
theme(plot.title = element_text(lineheight=1.5, face="bold"))
library(dplyr)
#======================Texas County count plot==================
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.integer(txshape$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS      <-as.integer(tx.accidents$FIPS )
txshape <- left_join(x = txshape ,y = tx.accidents,by = 'FIPS')
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="FIPS", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
)
write.csv('txshape',txshape)
write.csv(file='txshape',txshape)
write.csv(file='txshape.csv',txshape)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS      <-as.integer(tx.accidents$FIPS )
View(tx.accidents)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(tx.accidents,table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS      <-as.integer(tx.accidents$FIPS )
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(tx.accidents,table(tx.accidents))
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
table(tx.accidents)
data.frame(table(tx.accidents)
(table(tx.accidents)
table(tx.accidents)
data.frame(table(tx.accidents))
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
View(tx.accidents)
tx.accidents$FIPS      <-as.integer(tx.accidents$FIPS )
View(tx.accidents)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.factor(txshape$FIPS)
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.factor(txshape$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
txshape <- left_join(x = txshape ,y = tx.accidents,by = 'FIPS')
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="FIPS", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient(low = "white", high = "darkred") +
ggtitle('TX ACCIDENT COUNT DATA BY COUNTY')+
theme(plot.title = element_text(lineheight=1.5, face="bold"))
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.numeric(txshape$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
tx.accidents[,1]       <- as.numeric(tx.accidents[,1])
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.factor(txshape$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
txshape <- left_join(x = txshape ,y = tx.accidents,by = 'FIPS')
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="FIPS", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient(low = "white", high = "darkred") +
ggtitle('TX ACCIDENT COUNT DATA BY COUNTY')+
theme(plot.title = element_text(lineheight=1.5, face="bold"))
write.csv('txshape.csv',txshape)
write.csv(file='txshape.csv',txshape)
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.character(txshape$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accident$FIPS       <- as.character(tx.accident$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS       <- as.character(tx.accidents$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=T )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS       <- as.character(tx.accidents$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=T )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=T )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- read.csv('accident.csv')
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
View(tx.accidents)
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.integer(txshape$FIPS)
tx.accidents           <- read.csv('accident.csv')
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
as.integer(tx.accidents)
as.integer(tx.accidents[,1])
tx.accidents[,1]
as.numeric(tx.accidents[,1])
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
levels(tx.accidents[,1])
as.interger(levels(tx.accidents[,1]))
as.integer(levels(tx.accidents[,1]))
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS      <-   as.integer(levels(tx.accidents[,1]))
txshape$FIPS)
txshape$FIPS
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
as.integer(txshape$FIPS)
unique(as.integer(txshape$FIPS))
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.integer(txshape$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS      <-   as.integer(levels(tx.accidents[,1]))
txshape <- left_join(x = txshape ,y = tx.accidents,by = 'FIPS')
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="FIPS", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient(low = "white", high = "darkred") +
ggtitle('TX ACCIDENT COUNT DATA BY COUNTY')+
theme(plot.title = element_text(lineheight=1.5, face="bold"))
library(sp)
library(maptools)
library(ggplot2)
library(dplyr)
dir<-"D:\\GEOG5330\\R\\week3-bckronkosky"
setwd(dir)
#===============================US overall plot===================
usshape   <-readShapeSpatial('US_Bndry_Jursidictional_TIGER.shp',
proj4string = CRS("+proj=longlat")
)
accidents <- read.csv('accident.csv',stringsAsFactors=FALSE )
accidents <- accidents[accidents$LONGITUD<0,]
coordinates(accidents)<- ~LONGITUD+LATITUDE
plot(usshape)
points(accidents,pch=16,cex=.05, col="red" )
#================================================================
#======================Texas County count plot==================
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.integer(txshape$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS      <-   as.integer(levels(tx.accidents[,1]))
txshape                <- left_join(x = txshape ,y = tx.accidents,by = 'FIPS')
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="FIPS", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient(low = "white", high = "darkred") +
ggtitle('TX ACCIDENT COUNT DATA BY COUNTY')+
theme(plot.title = element_text(lineheight=1.5, face="bold"))
#================================================================
library(sp)
library(maptools)
library(ggplot2)
library(dplyr)
dir<-"D:\\GEOG5330\\R\\week3-bckronkosky"
setwd(dir)
#===============================US overall plot===================
usshape   <-readShapeSpatial('US_Bndry_Jursidictional_TIGER.shp',
proj4string = CRS("+proj=longlat")
)
accidents <- read.csv('accident.csv',stringsAsFactors=FALSE )
accidents <- accidents[accidents$LONGITUD<0,]
coordinates(accidents)<- ~LONGITUD+LATITUDE
plot(usshape, main="US Accident Report Map")
points(accidents,pch=16,cex=.05, col="red" )
#================================================================
#======================Texas County count plot==================
txshape   <-readShapeSpatial('Tx_CntyBndry_Jurisdictional_STRATMAP.shp',
proj4string = CRS("+proj=longlat")
)
txshape                <- fortify(txshape,region='FIPS')
colnames(txshape)[6]   <- 'FIPS'
txshape$FIPS           <- as.integer(txshape$FIPS)
tx.accidents           <- read.csv('accident.csv',stringsAsFactors=FALSE )
tx.accidents           <- as.integer(tx.accidents[tx.accidents$STATE==48,10])
tx.accidents           <- data.frame(table(tx.accidents))
colnames(tx.accidents) <- c('FIPS','ACCIDENT_COUNT')
tx.accidents$FIPS      <-   as.integer(levels(tx.accidents[,1]))
txshape                <- left_join(x = txshape ,y = tx.accidents,by = 'FIPS')
ggplot() +
geom_polygon(data=txshape,
aes_string(x="long",y="lat", group="FIPS", fill= 'ACCIDENT_COUNT'),
color="black",
size=0.25
) +
scale_fill_gradient(low = "white", high = "darkred") +
ggtitle('TX ACCIDENT COUNT DATA BY COUNTY')+
theme(plot.title = element_text(lineheight=1.5, face="bold"))
#================================================================
